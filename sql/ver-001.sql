CREATE SEQUENCE roles_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
CREATE SEQUENCE users_id_seq INCREMENT BY 1 MINVALUE 1 START 1;
CREATE TABLE roles (id INT NOT NULL, name VARCHAR(255) NOT NULL, PRIMARY KEY(id));
CREATE TABLE users (id INT NOT NULL, school_id INT NOT NULL, email VARCHAR(255) NOT NULL, username TEXT NOT NULL, password VARCHAR(255) NOT NULL, givenName VARCHAR(255) DEFAULT NULL, familyName VARCHAR(255) DEFAULT NULL, isActive BOOLEAN NOT NULL, ts TIMESTAMP(0) WITHOUT TIME ZONE NOT NULL, lastLogin TIMESTAMP(0) WITHOUT TIME ZONE DEFAULT NULL, dtype VARCHAR(255) NOT NULL, PRIMARY KEY(id));
CREATE UNIQUE INDEX UNIQ_1483A5E9E7927C74 ON users (email);
CREATE UNIQUE INDEX UNIQ_1483A5E9F85E0677 ON users (username);
CREATE INDEX IDX_1483A5E9C32A47EE ON users (school_id);
CREATE TABLE user_role (user_id INT NOT NULL, role_id INT NOT NULL, PRIMARY KEY(user_id, role_id));
CREATE INDEX IDX_2DE8C6A3A76ED395 ON user_role (user_id);
CREATE INDEX IDX_2DE8C6A3D60322AC ON user_role (role_id);
CREATE TABLE Student (id INT NOT NULL, registrationNr VARCHAR(45) DEFAULT NULL, pesel VARCHAR(11) DEFAULT NULL, birthdate DATE DEFAULT NULL, birthplace VARCHAR(45) DEFAULT NULL, numberInDaily INT NOT NULL, PRIMARY KEY(id));
ALTER TABLE user_role ADD CONSTRAINT FK_2DE8C6A3A76ED395 FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE user_role ADD CONSTRAINT FK_2DE8C6A3D60322AC FOREIGN KEY (role_id) REFERENCES roles (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;
ALTER TABLE Student ADD CONSTRAINT FK_789E96AFBF396750 FOREIGN KEY (id) REFERENCES users (id) ON DELETE CASCADE NOT DEFERRABLE INITIALLY IMMEDIATE;